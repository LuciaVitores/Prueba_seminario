---
title: "Natalidad en función del PIB por comunidad autónoma."
author: "Lucía Vítores e Irene Gamazo"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Este [repositorio](https://github.com/LuciaVitores/Prueba_seminario) ha sido creado para almacenar la información correspondiente a la natalidad por comunidades autónomas relacionada con los índices del producto interior burto (PIB) en España. 

La información usada para realizar este trabajo ha sido obtenida en [Instituto Nacional de Estadística](https://www.ine.es/).

### __Natalidad y PIB.__
Al contrario de lo que se podría esperar, cuanta mayor riqueza tenga una zona, mayor PIB tendrá y, por tanto, menor será la tasa de natalidad comparada con otras zonas con un PIB más bajo.

Vamos a comprobarlo con las gráficas. 


### __Objetivos.__
Los principales objetivos de este repositorio son:

+ Estudiar graficamente los niveles de natalidad desde 2016 hasta 2020 en cada comunidad autónoma española. 
+ Conocer el valor del PIB correspondiente a cada comunidad autónoma española.
+ Comparar el crecimiento económico de las 19 comunidades autónomas españolas.
+ Relacionar estos niveles de natalidad en nuestro periodo de tiempo estudiado con los valores del PIB por comunidad autónoma.

### __Inserción de tablas.__
Insertaremos las tablas con los datos obtenidos sobre la natalidad en las comunidades autónomas españolas entre los años 2016 y 2020, así como los valores del PIB correspondientes a estos años. 

Primeros indicamos los paquetes de R que vamos a usar. 

```{r ,warning=FALSE,message=FALSE}
#install.packages('DT')
library(readxl)
library(DT)
library(tidyverse)
library(ggplot2)
```

Los nombres de las filas de los datos que hemos descargado en INE, estaban compuesto por un número y el nombre de la comunidad autónoma. Para un mejor trabajo de los datos y unos resultados más claros y precisos, se han eliminado los números dejando únicamente el nombre. 
Para ello hemos usado la función __mutate__, donde hemos relacionado los __levels__ (nombres que venían descritos) con los __labels__ (nombres que queríamos dar).

_Tabla sobre el nacimiento en el año 2016._
```{r}
X2016_2 <- read_excel("INPUT/Nacimiento - PIB/2016.2.xls") %>% 
mutate(`Comunidades autónomas` = factor(`Comunidades autónomas`,
levels = c("01 Andalucía", "02 Aragón", "03 Asturias, Principado de", "04 Balears, Illes","05 Canarias", "06 Cantabria", "07 Castilla y León", "08 Castilla - La Mancha", "09 Cataluña", "10 Comunitat Valenciana","11 Extremadura", "12 Galicia", "13 Madrid, Comunidad de", "14 Murcia, Región de", "15 Navarra, Comunidad Foral de", "16 País Vasco", "17 Rioja, La", "18 Ceuta", "19 Melilla"),
labels = c("Andalucía", "Aragón", "Asturias", "Baleares", "Canarias", "Cantabria", "Castilla y León", "Castilla la Mancha", "Cataluña","Valencia", "Extremadura", "Galicia", "Madrid", "Murcia", "Navarra","Pais Vasco", "La Rioja", "Ceuta","Melilla")))
DT::datatable(X2016_2)
```

```{r , message=FALSE} 
data("X2016_2")
ggplot(data = X2016_2, aes(x = `Comunidades autónomas` , y = Total)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_point()
  
```

En 2016,podemos observar que la comunidad con mayores cifras de natalidad es __Andalucía__ con unos valores entre los 6000 y los 7000 puntos, seguida de __Cataluña__ que presenta entre 5000 y 6000 nacimientos dependiendo del mes y __Madrid__ con valores que rondan siempre los 5000 nacimientos.La cuarta comunidad con mayor puntuación es __Valencia__ que muestra valores entre los 3000 y 4000 nacimientos.
Por otra parte, las comunidades que menos nacimientos registran son: __Ceuta__ con valores que generalmente no pasan de los 100 nacimientos y __Melilla__ que presenta entre 100 y 150 nacimientos cada mes.
__La Rioja__, __Cantabria__, __Asturias__, __Navarra__, __Baleares__, __Extremadura__ y __Aragón__ se encuentran dentro de unos valores parecidos que no superan los 1000 nacimientos en ningún mes de 2016.
Por último, __Canarias__, __Castilla y León__ , __Castilla la Mancha__, __Galicia__, __Murcia__ y __País Vasco__ también presentan valores similares entre los 1000 y los 2000 nacimientos cada mes.

_Tabla sobre el nacimiento en el año 2017._
```{r}
X2017_2 <- read_excel("INPUT/Nacimiento - PIB/2017.2.xls")%>% 
mutate(`Comunidades autónomas` = factor(`Comunidades autónomas`,
levels = c("01 Andalucía", "02 Aragón", "03 Asturias, Principado de", "04 Balears, Illes","05 Canarias", "06 Cantabria", "07 Castilla y León", "08 Castilla - La Mancha", "09 Cataluña", "10 Comunitat Valenciana","11 Extremadura", "12 Galicia", "13 Madrid, Comunidad de", "14 Murcia, Región de", "15 Navarra, Comunidad Foral de", "16 País Vasco", "17 Rioja, La", "18 Ceuta", "19 Melilla"),
labels = c("Andalucía", "Aragón", "Asturias", "Baleares", "Canarias", "Cantabria", "Castilla y León", "Castilla la Mancha", "Cataluña","Valencia", "Extremadura", "Galicia", "Madrid", "Murcia", "Navarra","Pais Vasco", "La Rioja", "Ceuta","Melilla")))
DT::datatable(X2017_2)
```

```{r , message=FALSE} 
data("X2017_2")
ggplot(data = X2017_2, aes(x = `Comunidades autónomas` , y = Total)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_point()
  
```

En 2017 los resultados son similares a los que encontrábamos en 2016. __Andalucía__, __Cataluña__, __Madrdid__ y __Valencia__ son las comunidades con más nacimientos, con la diferencia de que en Andalucía, este año hay meses en los que no se alcanzan los 6000 nacimientos.
__Ceuta__ y __Melilla__ siguen siendo las cominidades con menor natalidad. 
Y el resto de comunidades se mantienen dentro de los mismos valores que podíamos observar en 2016.



_Tabla sobre el nacimiento en el año 2018._
```{r}
X2018_2 <- read_excel("INPUT/Nacimiento - PIB/2018.2.xls")%>% 
mutate(`Comunidades autónomas` = factor(`Comunidades autónomas`,
levels = c("01 Andalucía", "02 Aragón", "03 Asturias, Principado de", "04 Balears, Illes","05 Canarias", "06 Cantabria", "07 Castilla y León", "08 Castilla - La Mancha", "09 Cataluña", "10 Comunitat Valenciana","11 Extremadura", "12 Galicia", "13 Madrid, Comunidad de", "14 Murcia, Región de", "15 Navarra, Comunidad Foral de", "16 País Vasco", "17 Rioja, La", "18 Ceuta", "19 Melilla"),
labels = c("Andalucía", "Aragón", "Asturias", "Baleares", "Canarias", "Cantabria", "Castilla y León", "Castilla la Mancha", "Cataluña","Valencia", "Extremadura", "Galicia", "Madrid", "Murcia", "Navarra","Pais Vasco", "La Rioja", "Ceuta","Melilla")))
DT::datatable(X2018_2)
```

```{r , message=FALSE} 
data("X2018_2")
ggplot(data = X2018_2, aes(x = `Comunidades autónomas` , y = Total)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_point()
  
```

En 2018 vemos que los valores también son parecidos a los encontrados en los dos años anteriores, pero observamos que en las cuatro comunidades que presentan mayor natalidad las puntuaciones han bajado. Por ejemplo, encontramos en __Andalucía__ puntuaciones poco superiores a los 5000 nacimientos en algunos meses.
Los valores de __Ceuta__ y __Melilla__ siguen siendo similares al igual que en el resto de comunidades.


_Tabla sobre el nacimiento en el año 2019._
```{r}
X2019_2 <- read_excel("INPUT/Nacimiento - PIB/2019.2.xls")%>% 
mutate(`Comunidades autónomas` = factor(`Comunidades autónomas`,
levels = c("01 Andalucía", "02 Aragón", "03 Asturias, Principado de", "04 Balears, Illes","05 Canarias", "06 Cantabria", "07 Castilla y León", "08 Castilla - La Mancha", "09 Cataluña", "10 Comunitat Valenciana","11 Extremadura", "12 Galicia", "13 Madrid, Comunidad de", "14 Murcia, Región de", "15 Navarra, Comunidad Foral de", "16 País Vasco", "17 Rioja, La", "18 Ceuta", "19 Melilla"),
labels = c("Andalucía", "Aragón", "Asturias", "Baleares", "Canarias", "Cantabria", "Castilla y León", "Castilla la Mancha", "Cataluña","Valencia", "Extremadura", "Galicia", "Madrid", "Murcia", "Navarra","Pais Vasco", "La Rioja", "Ceuta","Melilla")))
DT::datatable(X2019_2)
```

```{r , message=FALSE} 
data("X2019_2")
ggplot(data = X2019_2, aes(x = `Comunidades autónomas` , y = Total)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_point()
  
```

En 2019 podemos ver que, aunque sigan encontrándose dentro de los mismos rangos, sigue la tendencia a disminuir los valores de natalidad en todas las comunidades autónomas Españolas.

_Tabla sobre el nacimiento en el año 2020._
```{r}
X2020_2 <- read_excel("INPUT/Nacimiento - PIB/2020.2.xls")%>% 
mutate(`Comunidades autónomas` = factor(`Comunidades autónomas`,
levels = c("01 Andalucía", "02 Aragón", "03 Asturias, Principado de", "04 Balears, Illes","05 Canarias", "06 Cantabria", "07 Castilla y León", "08 Castilla - La Mancha", "09 Cataluña", "10 Comunitat Valenciana","11 Extremadura", "12 Galicia", "13 Madrid, Comunidad de", "14 Murcia, Región de", "15 Navarra, Comunidad Foral de", "16 País Vasco", "17 Rioja, La", "18 Ceuta", "19 Melilla"),
labels = c("Andalucía", "Aragón", "Asturias", "Baleares", "Canarias", "Cantabria", "Castilla y León", "Castilla la Mancha", "Cataluña","Valencia", "Extremadura", "Galicia", "Madrid", "Murcia", "Navarra","Pais Vasco", "La Rioja", "Ceuta","Melilla")))
DT::datatable(X2020_2)
```

```{r , message=FALSE} 
data("X2020_2")
ggplot(data = X2020_2, aes(x = `Comunidades autónomas` , y = Total)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_point()
  
```

En 2020 continúa el descenso de la natalidad. Podemos observar que en el primer mes del año __Andalucía__ registra un valor cercano a los 4500 puntos, __Cataluña__ presenta cerca de 4000 puntos y __Madrid__ a penas supera los 3000 nacimientos.
__Ceuta__ y __Melilla__ se mantienen como las comunidades con menos natalidad y con valores similares a otros años.
Sin embargo, también observamos que __Canarias__, __Castilla la Mancha__, __Castilla y León__ y  __Murcia__ presentan algunos valores inferiores a los 1000 nacimientos.Teniendo en cuenta que en el resto de años, estas comunidades siempre presentaban valores superiores a los 1000 nacimientos, podemos afirmar que la natalidad tiende a descender cada año.


Hasta aquí cumplimos el primer objetivo ya que hemos representado gráficamente los valores de natalidad entre 2016 y 2020. Los resultado generales han demostrado que la natalidad se mantiene dentro de unos valores más o menos constantes a lo largo de los años aunque es importante recalcar que ha comenzado disminuir.
Aunque los valores de natalidad sean cada año un poco menores, __Andalucía__, __Cataluña__ y __Madrid__ son las comunidades con los niveles más altos y __Ceuta__ y __Melilla__ aquellas en los que se producen menos nacimientos.



```{r}
natalidad <- rbind(X2016_2, X2017_2, X2018_2, X2019_2, X2020_2)
natalidad
```


_Tabla sobre el PIB._
```{r}
PIB2 <- read_excel("INPUT/Nacimiento - PIB/PIB2.xls")
DT::datatable(PIB2)
```


```{r}
data("PIB2")
ggplot(data = PIB2) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_bar(
    mapping = aes(x = `Comunidades y ciudades autónomas`, fill = `Comunidades y ciudades autónomas`),
    width = 2
  )+
  theme(aspect.ratio = 1)+
  labs(x= NULL, y = NULL) + 
  coord_polar()
```

El segundo objetivo, conocer el valor el PIB de cada comunidad autónoma, ya se ha demostrado. 
Hacemos un gráfico circular para poder comparar mejor los resultados obtenidos, donde a cada comunidad/ciudad autónoma le corresponde un color determinado. 


```{r} 
natalidad <- left_join(x = X2016_2, y = left_join(x = X2017_2, y = left_join(x = X2018_2, y = left_join(x = X2019_2, y = X2020_2))), by = c("Total"))

nuevaNatalidad <- mean(natalidad)

```


```{r}
left <- left_join(x = PIB2, y = X2016_2)
left

```




This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


